<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2487.7">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 13.0px Menlo; color: #5a5a5a; -webkit-text-stroke: #5a5a5a}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 13.0px Menlo; color: #112d9e; -webkit-text-stroke: #112d9e}
    p.p3 {margin: 0.0px 0.0px 0.0px 0.0px; font: 13.0px Menlo; color: #14606b; -webkit-text-stroke: #14606b}
    p.p4 {margin: 0.0px 0.0px 0.0px 0.0px; font: 13.0px Menlo; color: #232526; -webkit-text-stroke: #232526}
    p.p5 {margin: 0.0px 0.0px 0.0px 0.0px; font: 13.0px Menlo; color: #8f000f; -webkit-text-stroke: #8f000f}
    p.p6 {margin: 0.0px 0.0px 0.0px 0.0px; font: 13.0px Menlo; color: #156536; -webkit-text-stroke: #156536}
    p.p7 {margin: 0.0px 0.0px 0.0px 0.0px; font: 13.0px Menlo; color: #4d009d; -webkit-text-stroke: #4d009d}
    p.p8 {margin: 0.0px 0.0px 0.0px 0.0px; font: 13.0px Menlo; color: #232526; -webkit-text-stroke: #232526; min-height: 15.0px}
    p.p9 {margin: 0.0px 0.0px 0.0px 0.0px; font: 13.0px Menlo; color: #3c3f43; -webkit-text-stroke: #3c3f43}
    p.p10 {margin: 0.0px 0.0px 0.0px 0.0px; font: 13.0px Menlo; color: #a90060; -webkit-text-stroke: #a90060}
    p.p11 {margin: 0.0px 0.0px 0.0px 0.0px; font: 13.0px Menlo; color: #131315; -webkit-text-stroke: #131315}
    p.p12 {margin: 0.0px 0.0px 0.0px 0.0px; font: 13.0px Menlo; color: #232526; -webkit-text-stroke: #232526; background-color: #f4f5f7}
    p.p13 {margin: 0.0px 0.0px 0.0px 0.0px; font: 13.0px Menlo; color: #232526; -webkit-text-stroke: #232526; background-color: #f4f5f7; min-height: 15.0px}
    span.s1 {font-kerning: none; background-color: #f4f5f7}
    span.s2 {font-kerning: none; color: #f6000b; background-color: #f4f5f7; -webkit-text-stroke: 0px #f6000b}
    span.s3 {font-kerning: none; color: #1f1f1f; background-color: #f4f5f7; -webkit-text-stroke: 0px #1f1f1f}
    span.s4 {font-kerning: none; color: #232526; background-color: #f4f5f7; -webkit-text-stroke: 0px #232526}
    span.s5 {font-kerning: none; color: #112d9e; background-color: #f4f5f7; -webkit-text-stroke: 0px #112d9e}
    span.s6 {font-kerning: none; color: #8f000f; background-color: #f4f5f7; -webkit-text-stroke: 0px #8f000f}
    span.s7 {font-kerning: none; color: #4d009d; background-color: #f4f5f7; -webkit-text-stroke: 0px #4d009d}
    span.s8 {font-kerning: none; color: #156536; background-color: #f4f5f7; -webkit-text-stroke: 0px #156536}
    span.s9 {font-kerning: none; color: #14606b; background-color: #f4f5f7; -webkit-text-stroke: 0px #14606b}
    span.s10 {font-kerning: none; color: #0b2981; background-color: #f4f5f7; -webkit-text-stroke: 0px #0b2981}
    span.s11 {font-kerning: none}
    span.s12 {font-kerning: none; color: #a90060; background-color: #f4f5f7; -webkit-text-stroke: 0px #a90060}
    span.s13 {font-kerning: none; color: #3c3f43; background-color: #f4f5f7; -webkit-text-stroke: 0px #3c3f43}
    span.s14 {font-kerning: none; color: #131315; background-color: #f4f5f7; -webkit-text-stroke: 0px #131315}
    span.s15 {font: 13.0px 'Apple Color Emoji'; font-kerning: none; background-color: #f4f5f7}
    span.s16 {font: 13.0px 'Apple Color Emoji'; font-kerning: none; color: #8f000f; background-color: #f4f5f7; -webkit-text-stroke: 0px #8f000f}
    span.s17 {font: 13.0px 'STIX Two Math'; font-kerning: none; color: #8f000f; background-color: #f4f5f7; -webkit-text-stroke: 0px #8f000f}
  </style>
</head>
<body>
<p class="p1"><span class="s1">&lt;!DOCTYPE</span><span class="s2"> html</span><span class="s1">&gt;</span></p>
<p class="p2"><span class="s3">&lt;</span><span class="s1">html</span><span class="s3">&gt;</span></p>
<p class="p2"><span class="s3">&lt;</span><span class="s1">head</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">  </span></span><span class="s3">&lt;</span><span class="s5">meta</span><span class="s4"> </span><span class="s1">charset</span><span class="s3">=</span><span class="s6">"UTF-8"</span><span class="s4"> </span><span class="s3">/&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">  </span></span><span class="s3">&lt;</span><span class="s5">title</span><span class="s3">&gt;</span><span class="s1">Snake 1100</span><span class="s3">&lt;/</span><span class="s5">title</span><span class="s3">&gt;</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">  </span></span><span class="s3">&lt;</span><span class="s1">style</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s7">:root</span><span class="s4"> { </span><span class="s1">--gap:</span><span class="s4"> </span><span class="s8">8px</span><span class="s4">; </span><span class="s1">--pad:</span><span class="s4"> </span><span class="s8">10px</span><span class="s4">; </span><span class="s1">--radius:</span><span class="s4"> </span><span class="s8">14px</span><span class="s4">; </span><span class="s1">--font:</span><span class="s4"> </span><span class="s8">13px</span><span class="s4">; }</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s7">body</span><span class="s1"> {</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">      </span></span><span class="s9">font-family:</span><span class="s4"> </span><span class="s1">ui-sans-serif</span><span class="s4">, </span><span class="s1">system-ui</span><span class="s4">, </span><span class="s1">-apple-system</span><span class="s4">, </span><span class="s1">Segoe</span><span class="s4"> </span><span class="s1">UI</span><span class="s4">, </span><span class="s1">Roboto</span><span class="s4">, </span><span class="s1">Arial</span><span class="s4">, </span><span class="s1">"Apple Color Emoji"</span><span class="s4">;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">      </span></span><span class="s1">margin:</span><span class="s4"> </span><span class="s8">0</span><span class="s4">; </span><span class="s1">padding:</span><span class="s4"> </span><span class="s6">var(--pad)</span><span class="s4">;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">      </span></span><span class="s1">background:</span><span class="s4"> </span><span class="s10">#0b0f14</span><span class="s4">; </span><span class="s1">color:</span><span class="s4"> </span><span class="s10">#e6edf3</span><span class="s4">;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">      </span></span><span class="s1">user-select:</span><span class="s4"> </span><span class="s6">none</span><span class="s4">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s7">.row</span><span class="s4"> { </span><span class="s1">display:</span><span class="s4"> </span><span class="s6">flex</span><span class="s4">; </span><span class="s1">align-items:</span><span class="s4"> </span><span class="s6">center</span><span class="s4">; </span><span class="s1">justify-content:</span><span class="s4"> </span><span class="s6">space-between</span><span class="s4">; </span><span class="s1">gap:</span><span class="s4"> </span><span class="s6">var(--gap)</span><span class="s4">; }</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s7">.col</span><span class="s4"> { </span><span class="s1">display:</span><span class="s4"> </span><span class="s6">flex</span><span class="s4">; </span><span class="s1">flex-direction:</span><span class="s4"> </span><span class="s6">column</span><span class="s4">; </span><span class="s1">gap:</span><span class="s4"> </span><span class="s6">var(--gap)</span><span class="s4">; }</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s7">.panel</span><span class="s1"> {</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">      </span></span><span class="s1">background:</span><span class="s4"> </span><span class="s10">#121722</span><span class="s4">; </span><span class="s1">padding:</span><span class="s4"> </span><span class="s8">10px</span><span class="s4">; </span><span class="s1">border-radius:</span><span class="s4"> </span><span class="s6">var(--radius)</span><span class="s4">;</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">      </span></span><span class="s9">box-shadow:</span><span class="s4"> </span><span class="s1">0</span><span class="s4"> </span><span class="s1">6px</span><span class="s4"> </span><span class="s1">18px</span><span class="s4"> </span><span class="s6">rgba(</span><span class="s1">0</span><span class="s4">,</span><span class="s1">0</span><span class="s4">,</span><span class="s1">0</span><span class="s4">,</span><span class="s1">.35</span><span class="s6">)</span><span class="s4">, </span><span class="s6">inset</span><span class="s4"> </span><span class="s1">0</span><span class="s4"> </span><span class="s1">1px</span><span class="s4"> </span><span class="s1">0</span><span class="s4"> </span><span class="s6">rgba(</span><span class="s1">255</span><span class="s4">,</span><span class="s1">255</span><span class="s4">,</span><span class="s1">255</span><span class="s4">,</span><span class="s1">.03</span><span class="s6">)</span><span class="s4">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s7">#canvasWrap</span><span class="s4"> { </span><span class="s1">display:</span><span class="s4"> </span><span class="s6">flex</span><span class="s4">; </span><span class="s1">justify-content:</span><span class="s4"> </span><span class="s6">center</span><span class="s4">; }</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s7">canvas</span><span class="s1"> {</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">      </span></span><span class="s1">background:</span><span class="s4"> </span><span class="s10">#05070b</span><span class="s4">; </span><span class="s1">border-radius:</span><span class="s4"> </span><span class="s8">12px</span><span class="s4">; </span><span class="s1">box-shadow:</span><span class="s4"> </span><span class="s6">inset</span><span class="s4"> </span><span class="s8">0</span><span class="s4"> </span><span class="s8">0</span><span class="s4"> </span><span class="s8">0</span><span class="s4"> </span><span class="s8">2px</span><span class="s4"> </span><span class="s10">#1b2432</span><span class="s4">;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">      </span></span><span class="s1">image-rendering:</span><span class="s4"> </span><span class="s6">pixelated</span><span class="s4">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s7">.stat</span><span class="s4"> { </span><span class="s1">font-size:</span><span class="s4"> </span><span class="s6">var(--font)</span><span class="s4">; </span><span class="s1">opacity:</span><span class="s4"> </span><span class="s8">.9</span><span class="s4">; }</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s7">.label</span><span class="s1"> { </span><span class="s9">opacity:</span><span class="s1"> </span><span class="s8">.7</span><span class="s1">; }</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s7">.value</span><span class="s4"> { </span><span class="s1">font-weight:</span><span class="s4"> </span><span class="s8">700</span><span class="s4">; </span><span class="s1">margin-left:</span><span class="s4"> </span><span class="s8">6px</span><span class="s4">; }</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s7">.btn</span><span class="s1"> {</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">      </span></span><span class="s1">font-size:</span><span class="s4"> </span><span class="s8">13px</span><span class="s4">; </span><span class="s1">font-weight:</span><span class="s4"> </span><span class="s8">600</span><span class="s4">; </span><span class="s1">line-height:</span><span class="s4"> </span><span class="s8">1</span><span class="s4">;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">      </span></span><span class="s1">padding:</span><span class="s4"> </span><span class="s8">10px</span><span class="s4"> </span><span class="s8">12px</span><span class="s4">; </span><span class="s1">border-radius:</span><span class="s4"> </span><span class="s8">12px</span><span class="s4">; </span><span class="s1">border:</span><span class="s4"> </span><span class="s8">0</span><span class="s4">; </span><span class="s1">cursor:</span><span class="s4"> </span><span class="s6">pointer</span><span class="s4">;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">      </span></span><span class="s1">background:</span><span class="s4"> </span><span class="s10">#1f2937</span><span class="s4">; </span><span class="s1">color:</span><span class="s4"> </span><span class="s10">#e6edf3</span><span class="s4">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">      </span></span><span class="s9">box-shadow:</span><span class="s1"> </span><span class="s8">0</span><span class="s1"> </span><span class="s8">4px</span><span class="s1"> </span><span class="s8">10px</span><span class="s1"> </span><span class="s6">rgba(</span><span class="s8">0</span><span class="s1">,</span><span class="s8">0</span><span class="s1">,</span><span class="s8">0</span><span class="s1">,</span><span class="s8">.4</span><span class="s6">)</span><span class="s1">;</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">      </span></span><span class="s9">transition:</span><span class="s4"> </span><span class="s1">transform</span><span class="s4"> </span><span class="s8">.05s</span><span class="s4"> </span><span class="s1">ease</span><span class="s4">, </span><span class="s1">filter</span><span class="s4"> </span><span class="s8">.2s</span><span class="s4"> </span><span class="s1">ease</span><span class="s4">, </span><span class="s1">background</span><span class="s4"> </span><span class="s8">.2s</span><span class="s4"> </span><span class="s1">ease</span><span class="s4">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s7">.btn:active</span><span class="s4"> { </span><span class="s9">transform:</span><span class="s4"> </span><span class="s1">translateY(</span><span class="s8">1px</span><span class="s1">)</span><span class="s4"> </span><span class="s1">scale(</span><span class="s8">.99</span><span class="s1">)</span><span class="s4">; </span><span class="s9">filter:</span><span class="s4"> </span><span class="s1">brightness(</span><span class="s8">.95</span><span class="s1">)</span><span class="s4">; }</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">.btn.primary</span><span class="s4"> { </span><span class="s9">background:</span><span class="s4"> </span><span class="s10">#2563eb</span><span class="s4">; }</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s7">.grid</span><span class="s1"> {</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">      </span></span><span class="s1">display:</span><span class="s4"> </span><span class="s6">grid</span><span class="s4">; </span><span class="s1">grid-template-columns:</span><span class="s4"> </span><span class="s6">repeat(</span><span class="s8">3</span><span class="s4">, </span><span class="s8">1fr</span><span class="s6">)</span><span class="s4">; </span><span class="s1">gap:</span><span class="s4"> </span><span class="s6">var(--gap)</span><span class="s4">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s7">.dpad</span><span class="s1"> {</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">      </span></span><span class="s9">display:</span><span class="s1"> </span><span class="s6">grid</span><span class="s1">;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">      </span></span><span class="s1">grid-template-columns:</span><span class="s4"> </span><span class="s6">repeat(</span><span class="s8">3</span><span class="s4">, </span><span class="s8">45px</span><span class="s6">)</span><span class="s4">;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">      </span></span><span class="s1">grid-template-rows:</span><span class="s4"> </span><span class="s6">repeat(</span><span class="s8">3</span><span class="s4">, </span><span class="s8">45px</span><span class="s6">)</span><span class="s4">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">      </span></span><span class="s9">gap:</span><span class="s1"> </span><span class="s8">4px</span><span class="s1">;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">      </span></span><span class="s1">justify-content:</span><span class="s4"> </span><span class="s6">center</span><span class="s4">;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">      </span></span><span class="s1">margin-top:</span><span class="s4"> </span><span class="s8">4px</span><span class="s4">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">.dpad</span><span class="s4"> </span><span class="s1">.btn</span><span class="s4"> {</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">      </span></span><span class="s9">width:</span><span class="s1"> </span><span class="s8">45px</span><span class="s1">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">      </span></span><span class="s9">height:</span><span class="s1"> </span><span class="s8">45px</span><span class="s1">;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">      </span></span><span class="s1">border-radius:</span><span class="s4"> </span><span class="s8">10px</span><span class="s4">;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">      </span></span><span class="s1">font-size:</span><span class="s4"> </span><span class="s8">16px</span><span class="s4">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">      </span></span><span class="s9">padding:</span><span class="s1"> </span><span class="s8">0</span><span class="s1">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s7">.muted</span><span class="s1"> { </span><span class="s9">opacity:</span><span class="s1"> </span><span class="s8">.65</span><span class="s1">; }</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s7">.toast</span><span class="s1"> {</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">      </span></span><span class="s1">position:</span><span class="s4"> </span><span class="s6">absolute</span><span class="s4">; </span><span class="s1">left:</span><span class="s4"> </span><span class="s8">0</span><span class="s4">; </span><span class="s1">right:</span><span class="s4"> </span><span class="s8">0</span><span class="s4">; </span><span class="s1">top:</span><span class="s4"> </span><span class="s8">8px</span><span class="s4">; </span><span class="s1">text-align:</span><span class="s4"> </span><span class="s6">center</span><span class="s4">; </span><span class="s1">pointer-events:</span><span class="s4"> </span><span class="s6">none</span><span class="s4">;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">      </span></span><span class="s1">font-weight:</span><span class="s4"> </span><span class="s8">700</span><span class="s4">; </span><span class="s1">text-shadow:</span><span class="s4"> </span><span class="s8">0</span><span class="s4"> </span><span class="s8">2px</span><span class="s4"> </span><span class="s8">6px</span><span class="s4"> </span><span class="s6">rgba(</span><span class="s8">0</span><span class="s4">,</span><span class="s8">0</span><span class="s4">,</span><span class="s8">0</span><span class="s4">,</span><span class="s8">.6</span><span class="s6">)</span><span class="s4">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s7">.badge</span><span class="s4"> { </span><span class="s1">background:</span><span class="s4"> </span><span class="s10">#111827</span><span class="s4">; </span><span class="s1">border:</span><span class="s4"> </span><span class="s8">1px</span><span class="s4"> </span><span class="s6">solid</span><span class="s4"> </span><span class="s10">#1f2937</span><span class="s4">; </span><span class="s1">padding:</span><span class="s4"> </span><span class="s8">6px</span><span class="s4"> </span><span class="s8">10px</span><span class="s4">; </span><span class="s1">border-radius:</span><span class="s4"> </span><span class="s8">999px</span><span class="s4">; </span><span class="s1">font-size:</span><span class="s4"> </span><span class="s8">12px</span><span class="s4">; }</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">  </span></span><span class="s3">&lt;/</span><span class="s1">style</span><span class="s3">&gt;</span></p>
<p class="p2"><span class="s3">&lt;/</span><span class="s1">head</span><span class="s3">&gt;</span></p>
<p class="p2"><span class="s3">&lt;</span><span class="s1">body</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">  </span></span><span class="s3">&lt;</span><span class="s5">div</span><span class="s4"> </span><span class="s9">class</span><span class="s3">=</span><span class="s1">"toast"</span><span class="s4"> </span><span class="s9">id</span><span class="s3">=</span><span class="s1">"toast"</span><span class="s3">&gt;&lt;/</span><span class="s5">div</span><span class="s3">&gt;</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">  </span></span><span class="s3">&lt;</span><span class="s5">div</span><span class="s4"> </span><span class="s9">class</span><span class="s3">=</span><span class="s1">"row"</span><span class="s4"> </span><span class="s9">style</span><span class="s3">=</span><span class="s1">"margin-bottom:10px"</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s5">div</span><span class="s4"> </span><span class="s9">class</span><span class="s3">=</span><span class="s1">"stat"</span><span class="s3">&gt;&lt;</span><span class="s5">span</span><span class="s4"> </span><span class="s9">class</span><span class="s3">=</span><span class="s1">"label"</span><span class="s3">&gt;</span><span class="s4">Score</span><span class="s3">&lt;/</span><span class="s5">span</span><span class="s3">&gt;&lt;</span><span class="s5">span</span><span class="s4"> </span><span class="s9">class</span><span class="s3">=</span><span class="s1">"value"</span><span class="s4"> </span><span class="s9">id</span><span class="s3">=</span><span class="s1">"score"</span><span class="s3">&gt;</span><span class="s4">0</span><span class="s3">&lt;/</span><span class="s5">span</span><span class="s3">&gt;&lt;/</span><span class="s5">div</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s5">div</span><span class="s4"> </span><span class="s9">class</span><span class="s3">=</span><span class="s1">"stat"</span><span class="s3">&gt;&lt;</span><span class="s5">span</span><span class="s4"> </span><span class="s9">class</span><span class="s3">=</span><span class="s1">"label"</span><span class="s3">&gt;</span><span class="s4">High</span><span class="s3">&lt;/</span><span class="s5">span</span><span class="s3">&gt;&lt;</span><span class="s5">span</span><span class="s4"> </span><span class="s9">class</span><span class="s3">=</span><span class="s1">"value"</span><span class="s4"> </span><span class="s9">id</span><span class="s3">=</span><span class="s1">"high"</span><span class="s3">&gt;</span><span class="s4">0</span><span class="s3">&lt;/</span><span class="s5">span</span><span class="s3">&gt;&lt;/</span><span class="s5">div</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s5">div</span><span class="s4"> </span><span class="s9">class</span><span class="s3">=</span><span class="s1">"stat"</span><span class="s3">&gt;&lt;</span><span class="s5">span</span><span class="s4"> </span><span class="s9">class</span><span class="s3">=</span><span class="s1">"label"</span><span class="s3">&gt;</span><span class="s4">Level</span><span class="s3">&lt;/</span><span class="s5">span</span><span class="s3">&gt;&lt;</span><span class="s5">span</span><span class="s4"> </span><span class="s9">class</span><span class="s3">=</span><span class="s1">"value"</span><span class="s4"> </span><span class="s9">id</span><span class="s3">=</span><span class="s1">"level"</span><span class="s3">&gt;</span><span class="s4">1</span><span class="s3">&lt;/</span><span class="s5">span</span><span class="s3">&gt;&lt;/</span><span class="s5">div</span><span class="s3">&gt;</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">  </span></span><span class="s3">&lt;/</span><span class="s1">div</span><span class="s3">&gt;</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">  </span></span><span class="s3">&lt;</span><span class="s5">div</span><span class="s4"> </span><span class="s9">id</span><span class="s3">=</span><span class="s1">"canvasWrap"</span><span class="s4"> </span><span class="s9">class</span><span class="s3">=</span><span class="s1">"panel"</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s5">canvas</span><span class="s4"> </span><span class="s9">id</span><span class="s3">=</span><span class="s1">"game"</span><span class="s4"> </span><span class="s9">width</span><span class="s3">=</span><span class="s1">"300"</span><span class="s4"> </span><span class="s9">height</span><span class="s3">=</span><span class="s1">"300"</span><span class="s3">&gt;&lt;/</span><span class="s5">canvas</span><span class="s3">&gt;</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">  </span></span><span class="s3">&lt;/</span><span class="s1">div</span><span class="s3">&gt;</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">  </span></span><span class="s3">&lt;</span><span class="s5">div</span><span class="s4"> </span><span class="s9">class</span><span class="s3">=</span><span class="s1">"row"</span><span class="s4"> </span><span class="s9">style</span><span class="s3">=</span><span class="s1">"margin-top:10px"</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s5">button</span><span class="s4"> </span><span class="s9">class</span><span class="s3">=</span><span class="s1">"btn primary"</span><span class="s4"> </span><span class="s9">id</span><span class="s3">=</span><span class="s1">"playPause"</span><span class="s3">&gt;</span><span class="s4">▶ Start</span><span class="s3">&lt;/</span><span class="s5">button</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s5">button</span><span class="s1"> </span><span class="s9">class</span><span class="s3">=</span><span class="s6">"btn"</span><span class="s1"> </span><span class="s9">id</span><span class="s3">=</span><span class="s6">"restart"</span><span class="s3">&gt;</span><span class="s1">↻ Restart</span><span class="s3">&lt;/</span><span class="s5">button</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s5">span</span><span class="s1"> </span><span class="s9">class</span><span class="s3">=</span><span class="s6">"badge muted"</span><span class="s3">&gt;</span><span class="s1">Nokia 1100 mode (no wall wrap)</span><span class="s3">&lt;/</span><span class="s5">span</span><span class="s3">&gt;</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">  </span></span><span class="s3">&lt;/</span><span class="s1">div</span><span class="s3">&gt;</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">  </span></span><span class="s3">&lt;</span><span class="s5">div</span><span class="s4"> </span><span class="s9">class</span><span class="s3">=</span><span class="s1">"dpad"</span><span class="s3">&gt;</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s1">div</span><span class="s3">&gt;&lt;/</span><span class="s1">div</span><span class="s3">&gt;</span><span class="s4"> </span><span class="s3">&lt;</span><span class="s1">button</span><span class="s4"> </span><span class="s9">class</span><span class="s3">=</span><span class="s6">"btn"</span><span class="s4"> </span><span class="s9">id</span><span class="s3">=</span><span class="s6">"up"</span><span class="s3">&gt;</span><span class="s4">▲</span><span class="s3">&lt;/</span><span class="s1">button</span><span class="s3">&gt;</span><span class="s4"> </span><span class="s3">&lt;</span><span class="s1">div</span><span class="s3">&gt;&lt;/</span><span class="s1">div</span><span class="s3">&gt;</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s1">button</span><span class="s4"> </span><span class="s9">class</span><span class="s3">=</span><span class="s6">"btn"</span><span class="s4"> </span><span class="s9">id</span><span class="s3">=</span><span class="s6">"left"</span><span class="s3">&gt;</span><span class="s4">◀</span><span class="s3">&lt;/</span><span class="s1">button</span><span class="s3">&gt;</span><span class="s4"> </span><span class="s3">&lt;</span><span class="s1">div</span><span class="s3">&gt;&lt;/</span><span class="s1">div</span><span class="s3">&gt;</span><span class="s4"> </span><span class="s3">&lt;</span><span class="s1">button</span><span class="s4"> </span><span class="s9">class</span><span class="s3">=</span><span class="s6">"btn"</span><span class="s4"> </span><span class="s9">id</span><span class="s3">=</span><span class="s6">"right"</span><span class="s3">&gt;</span><span class="s4">▶</span><span class="s3">&lt;/</span><span class="s1">button</span><span class="s3">&gt;</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s1">div</span><span class="s3">&gt;&lt;/</span><span class="s1">div</span><span class="s3">&gt;</span><span class="s4"> </span><span class="s3">&lt;</span><span class="s1">button</span><span class="s4"> </span><span class="s9">class</span><span class="s3">=</span><span class="s6">"btn"</span><span class="s4"> </span><span class="s9">id</span><span class="s3">=</span><span class="s6">"down"</span><span class="s3">&gt;</span><span class="s4">▼</span><span class="s3">&lt;/</span><span class="s1">button</span><span class="s3">&gt;</span><span class="s4"> </span><span class="s3">&lt;</span><span class="s1">div</span><span class="s3">&gt;&lt;/</span><span class="s1">div</span><span class="s3">&gt;</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">  </span></span><span class="s3">&lt;/</span><span class="s1">div</span><span class="s3">&gt;</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">  </span></span><span class="s3">&lt;</span><span class="s1">script</span><span class="s3">&gt;</span></p>
<p class="p9"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">// --- Config ---</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s5">const</span><span class="s1"> </span><span class="s12">ROWS</span><span class="s1"> = </span><span class="s9">20</span><span class="s1">, </span><span class="s12">COLS</span><span class="s1"> = </span><span class="s9">20</span><span class="s1">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s5">const</span><span class="s1"> </span><span class="s12">CELL</span><span class="s1"> = </span><span class="s9">14</span><span class="s1">;<span class="Apple-converted-space">              </span></span><span class="s13">// pixel size of a cell</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s5">const</span><span class="s1"> </span><span class="s12">GAP</span><span class="s1"><span class="Apple-converted-space">  </span>= </span><span class="s9">0</span><span class="s1">; <span class="Apple-converted-space">              </span></span><span class="s13">// inner gap</span></p>
<p class="p9"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s5">const</span><span class="s4"> </span><span class="s12">WALLS_KILL</span><span class="s4"> = </span><span class="s5">true</span><span class="s4">;<span class="Apple-converted-space">      </span></span><span class="s1">// Nokia 1100 style</span></p>
<p class="p9"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s5">const</span><span class="s4"> </span><span class="s12">START_SPEED_MS</span><span class="s4"> = </span><span class="s9">220</span><span class="s4">; <span class="Apple-converted-space">  </span></span><span class="s1">// lower = faster</span></p>
<p class="p9"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s5">const</span><span class="s4"> </span><span class="s12">SPEED_STEP_MS</span><span class="s4"><span class="Apple-converted-space">  </span>= </span><span class="s9">8</span><span class="s4">; <span class="Apple-converted-space">    </span></span><span class="s1">// speed up per level</span></p>
<p class="p10"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s5">const</span><span class="s4"> </span><span class="s1">FOODS_PER_LEVEL</span><span class="s4"> = </span><span class="s9">5</span><span class="s4">;</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p9"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">// --- Canvas setup ---</span></p>
<p class="p11"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s5">const</span><span class="s4"> </span><span class="s1">canvas</span><span class="s4"> = </span><span class="s1">document</span><span class="s4">.</span><span class="s1">getElementById</span><span class="s4">(</span><span class="s6">'game'</span><span class="s4">);</span></p>
<p class="p11"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s5">const</span><span class="s4"> </span><span class="s1">ctx</span><span class="s4"> = </span><span class="s1">canvas</span><span class="s4">.</span><span class="s1">getContext</span><span class="s4">(</span><span class="s6">'2d'</span><span class="s4">);</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p9"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">// Center the 20x20 grid nicely within canvas</span></p>
<p class="p11"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s5">const</span><span class="s4"> </span><span class="s1">gridSizePx</span><span class="s4"> = </span><span class="s12">Math</span><span class="s4">.</span><span class="s1">min</span><span class="s4">(</span><span class="s1">canvas</span><span class="s4">.</span><span class="s1">width</span><span class="s4">, </span><span class="s1">canvas</span><span class="s4">.</span><span class="s1">height</span><span class="s4">);</span></p>
<p class="p9"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s5">const</span><span class="s4"> </span><span class="s14">cellPx</span><span class="s4"> = </span><span class="s12">Math</span><span class="s4">.</span><span class="s14">floor</span><span class="s4">(</span><span class="s14">gridSizePx</span><span class="s4"> / </span><span class="s12">ROWS</span><span class="s4">); </span><span class="s1">// just in case you resize</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s5">const</span><span class="s1"> </span><span class="s14">marginX</span><span class="s1"> = </span><span class="s12">Math</span><span class="s1">.</span><span class="s14">floor</span><span class="s1">((</span><span class="s14">canvas</span><span class="s1">.</span><span class="s14">width</span><span class="s1"><span class="Apple-converted-space">  </span>- </span><span class="s12">COLS</span><span class="s1"> * </span><span class="s12">CELL</span><span class="s1">) / </span><span class="s9">2</span><span class="s1">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s5">const</span><span class="s1"> </span><span class="s14">marginY</span><span class="s1"> = </span><span class="s12">Math</span><span class="s1">.</span><span class="s14">floor</span><span class="s1">((</span><span class="s14">canvas</span><span class="s1">.</span><span class="s14">height</span><span class="s1"> - </span><span class="s12">ROWS</span><span class="s1"> * </span><span class="s12">CELL</span><span class="s1">) / </span><span class="s9">2</span><span class="s1">);</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p9"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">// --- UI elements ---</span></p>
<p class="p11"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s5">const</span><span class="s4"> </span><span class="s1">scoreEl</span><span class="s4"> = </span><span class="s1">document</span><span class="s4">.</span><span class="s1">getElementById</span><span class="s4">(</span><span class="s6">'score'</span><span class="s4">);</span></p>
<p class="p11"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s5">const</span><span class="s4"> </span><span class="s1">highEl</span><span class="s4"><span class="Apple-converted-space">  </span>= </span><span class="s1">document</span><span class="s4">.</span><span class="s1">getElementById</span><span class="s4">(</span><span class="s6">'high'</span><span class="s4">);</span></p>
<p class="p11"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s5">const</span><span class="s4"> </span><span class="s1">levelEl</span><span class="s4"> = </span><span class="s1">document</span><span class="s4">.</span><span class="s1">getElementById</span><span class="s4">(</span><span class="s6">'level'</span><span class="s4">);</span></p>
<p class="p11"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s5">const</span><span class="s4"> </span><span class="s1">playPauseBtn</span><span class="s4"> = </span><span class="s1">document</span><span class="s4">.</span><span class="s1">getElementById</span><span class="s4">(</span><span class="s6">'playPause'</span><span class="s4">);</span></p>
<p class="p11"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s5">const</span><span class="s4"> </span><span class="s1">restartBtn</span><span class="s4"> <span class="Apple-converted-space">  </span>= </span><span class="s1">document</span><span class="s4">.</span><span class="s1">getElementById</span><span class="s4">(</span><span class="s6">'restart'</span><span class="s4">);</span></p>
<p class="p11"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s5">const</span><span class="s4"> </span><span class="s1">toastEl</span><span class="s4"><span class="Apple-converted-space">      </span>= </span><span class="s1">document</span><span class="s4">.</span><span class="s1">getElementById</span><span class="s4">(</span><span class="s6">'toast'</span><span class="s4">);</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p9"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">// --- Game state ---</span></p>
<p class="p11"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s5">let</span><span class="s4"> </span><span class="s1">snake</span><span class="s4">, </span><span class="s1">dir</span><span class="s4">, </span><span class="s1">pendingDir</span><span class="s4">, </span><span class="s1">food</span><span class="s4">, </span><span class="s1">score</span><span class="s4">, </span><span class="s1">level</span><span class="s4">, </span><span class="s1">tickMs</span><span class="s4">, </span><span class="s1">running</span><span class="s4">, </span><span class="s1">lastTick</span><span class="s4">;</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p11"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s5">function</span><span class="s4"> </span><span class="s1">resetState</span><span class="s4">() {</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">      </span></span><span class="s5">const</span><span class="s1"> </span><span class="s14">startR</span><span class="s1"> = </span><span class="s12">Math</span><span class="s1">.</span><span class="s14">floor</span><span class="s1">(</span><span class="s12">ROWS</span><span class="s1">/</span><span class="s9">2</span><span class="s1">), </span><span class="s14">startC</span><span class="s1"> = </span><span class="s12">Math</span><span class="s1">.</span><span class="s14">floor</span><span class="s1">(</span><span class="s12">COLS</span><span class="s1">/</span><span class="s9">2</span><span class="s1">);</span></p>
<p class="p11"><span class="s4"><span class="Apple-converted-space">      </span></span><span class="s1">snake</span><span class="s4"> = [{</span><span class="s1">r</span><span class="s4">:</span><span class="s1">startR</span><span class="s4">, </span><span class="s1">c</span><span class="s4">:</span><span class="s1">startC</span><span class="s4">}];</span></p>
<p class="p9"><span class="s4"><span class="Apple-converted-space">      </span></span><span class="s14">dir</span><span class="s4"> = {</span><span class="s14">r</span><span class="s4">:</span><span class="s9">0</span><span class="s4">, </span><span class="s14">c</span><span class="s4">:</span><span class="s9">1</span><span class="s4">}; <span class="Apple-converted-space">  </span></span><span class="s1">// moving RIGHT by default</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">      </span></span><span class="s14">pendingDir</span><span class="s1"> = </span><span class="s5">null</span><span class="s1">;</span></p>
<p class="p11"><span class="s4"><span class="Apple-converted-space">      </span></span><span class="s1">food</span><span class="s4"> = </span><span class="s1">randomEmptyCell</span><span class="s4">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">      </span></span><span class="s14">score</span><span class="s1"> = </span><span class="s9">0</span><span class="s1">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">      </span></span><span class="s14">level</span><span class="s1"> = </span><span class="s9">1</span><span class="s1">;</span></p>
<p class="p10"><span class="s4"><span class="Apple-converted-space">      </span></span><span class="s14">tickMs</span><span class="s4"> = </span><span class="s1">START_SPEED_MS</span><span class="s4">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">      </span></span><span class="s14">running</span><span class="s1"> = </span><span class="s5">false</span><span class="s1">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">      </span></span><span class="s14">lastTick</span><span class="s1"> = </span><span class="s9">0</span><span class="s1">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">      </span></span><span class="s14">updateHud</span><span class="s1">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">      </span></span><span class="s14">draw</span><span class="s1">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">      </span></span><span class="s14">showToast</span><span class="s1">(</span><span class="s6">'Ready'</span><span class="s1">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s5">function</span><span class="s1"> </span><span class="s14">updateHud</span><span class="s1">() {</span></p>
<p class="p11"><span class="s4"><span class="Apple-converted-space">      </span></span><span class="s1">scoreEl</span><span class="s4">.</span><span class="s1">textContent</span><span class="s4"> = </span><span class="s1">score</span><span class="s4">;</span></p>
<p class="p11"><span class="s4"><span class="Apple-converted-space">      </span></span><span class="s1">levelEl</span><span class="s4">.</span><span class="s1">textContent</span><span class="s4"> = </span><span class="s1">level</span><span class="s4">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p9"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">// High score (load from server)</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span>//(</span><span class="s5">function</span><span class="s1"> </span><span class="s14">loadHigh</span><span class="s1">() {</span></p>
<p class="p11"><span class="s4"><span class="Apple-converted-space">      </span>//</span><span class="s5">if</span><span class="s4"> (</span><span class="s5">typeof</span><span class="s4"> </span><span class="s1">google</span><span class="s4"> !== </span><span class="s6">'undefined'</span><span class="s4"> &amp;&amp; </span><span class="s1">google</span><span class="s4">.</span><span class="s1">script</span><span class="s4"> &amp;&amp; </span><span class="s1">google</span><span class="s4">.</span><span class="s1">script</span><span class="s4">.</span><span class="s1">run</span><span class="s4">) {</span></p>
<p class="p11"><span class="s4"><span class="Apple-converted-space">        </span>//</span><span class="s1">google</span><span class="s4">.</span><span class="s1">script</span><span class="s4">.</span><span class="s1">run</span><span class="s4">.</span><span class="s1">withSuccessHandler</span><span class="s4">(</span><span class="s1">v</span><span class="s4"> =&gt; {</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">          </span>//</span><span class="s14">highEl</span><span class="s1">.</span><span class="s14">textContent</span><span class="s1"> = </span><span class="s14">v</span><span class="s1"> || </span><span class="s9">0</span><span class="s1">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span>//}).</span><span class="s14">getHighScore</span><span class="s1">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">      </span>//} </span><span class="s5">else</span><span class="s1"> {</span></p>
<p class="p11"><span class="s4"><span class="Apple-converted-space">        </span>//</span><span class="s1">highEl</span><span class="s4">.</span><span class="s1">textContent</span><span class="s4"> = </span><span class="s9">0</span><span class="s4">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">      </span>//}</span></p>
<p class="p12"><span class="s11"><span class="Apple-converted-space">    </span>//})();</span></p>
<p class="p13"><span class="s11"></span><br></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p11"><span class="s4"><span class="Apple-converted-space">    </span>//</span><span class="s5">function</span><span class="s4"> </span><span class="s1">setHighIfBeaten</span><span class="s4">(</span><span class="s1">s</span><span class="s4">) {</span></p>
<p class="p11"><span class="s4"><span class="Apple-converted-space">      </span>//</span><span class="s5">const</span><span class="s4"> </span><span class="s1">current</span><span class="s4"> = </span><span class="s12">Number</span><span class="s4">(</span><span class="s1">highEl</span><span class="s4">.</span><span class="s1">textContent</span><span class="s4"> || </span><span class="s9">0</span><span class="s4">);</span></p>
<p class="p11"><span class="s4"><span class="Apple-converted-space">      </span>//</span><span class="s5">if</span><span class="s4"> (</span><span class="s1">s</span><span class="s4"> &gt; </span><span class="s1">current</span><span class="s4"> &amp;&amp; </span><span class="s5">typeof</span><span class="s4"> </span><span class="s1">google</span><span class="s4"> !== </span><span class="s6">'undefined'</span><span class="s4"> &amp;&amp; </span><span class="s1">google</span><span class="s4">.</span><span class="s1">script</span><span class="s4"> &amp;&amp; </span><span class="s1">google</span><span class="s4">.</span><span class="s1">script</span><span class="s4">.</span><span class="s1">run</span><span class="s4">) {</span></p>
<p class="p11"><span class="s4"><span class="Apple-converted-space">        </span>//</span><span class="s1">google</span><span class="s4">.</span><span class="s1">script</span><span class="s4">.</span><span class="s1">run</span><span class="s4">.</span><span class="s1">withSuccessHandler</span><span class="s4">(() =&gt; {</span></p>
<p class="p11"><span class="s4"><span class="Apple-converted-space">          </span>//</span><span class="s1">highEl</span><span class="s4">.</span><span class="s1">textContent</span><span class="s4"> = </span><span class="s1">s</span><span class="s4">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span>//}).</span><span class="s14">setHighScore</span><span class="s1">(</span><span class="s14">s</span><span class="s1">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">      </span>//}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span>//}</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p9"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">// --- Helpers ---</span></p>
<p class="p11"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s5">function</span><span class="s4"> </span><span class="s1">randomEmptyCell</span><span class="s4">() {</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">      </span></span><span class="s5">const</span><span class="s1"> </span><span class="s14">occupied</span><span class="s1"> = </span><span class="s5">new</span><span class="s1"> </span><span class="s12">Set</span><span class="s1">(</span><span class="s14">snake</span><span class="s1">.</span><span class="s14">map</span><span class="s1">(</span><span class="s14">n</span><span class="s1"> =&gt; </span><span class="s6">`</span><span class="s1">${</span><span class="s14">n</span><span class="s1">.</span><span class="s14">r</span><span class="s1">}</span><span class="s6">,</span><span class="s1">${</span><span class="s14">n</span><span class="s1">.</span><span class="s14">c</span><span class="s1">}</span><span class="s6">`</span><span class="s1">));</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">      </span></span><span class="s5">let</span><span class="s1"> </span><span class="s14">r</span><span class="s1">, </span><span class="s14">c</span><span class="s1">, </span><span class="s14">tries</span><span class="s1"> = </span><span class="s9">0</span><span class="s1">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">      </span></span><span class="s5">do</span><span class="s1"> {</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s14">r</span><span class="s1"> = </span><span class="s9">1</span><span class="s1"> + </span><span class="s12">Math</span><span class="s1">.</span><span class="s14">floor</span><span class="s1">(</span><span class="s12">Math</span><span class="s1">.</span><span class="s14">random</span><span class="s1">() * </span><span class="s12">ROWS</span><span class="s1">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s14">c</span><span class="s1"> = </span><span class="s9">1</span><span class="s1"> + </span><span class="s12">Math</span><span class="s1">.</span><span class="s14">floor</span><span class="s1">(</span><span class="s12">Math</span><span class="s1">.</span><span class="s14">random</span><span class="s1">() * </span><span class="s12">COLS</span><span class="s1">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s14">tries</span><span class="s1">++;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s5">if</span><span class="s1"> (</span><span class="s14">tries</span><span class="s1"> &gt; </span><span class="s9">500</span><span class="s1">) </span><span class="s5">break</span><span class="s1">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">      </span>} </span><span class="s5">while</span><span class="s1"> (</span><span class="s14">occupied</span><span class="s1">.</span><span class="s14">has</span><span class="s1">(</span><span class="s6">`</span><span class="s1">${</span><span class="s14">r</span><span class="s1">}</span><span class="s6">,</span><span class="s1">${</span><span class="s14">c</span><span class="s1">}</span><span class="s6">`</span><span class="s1">));</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">      </span></span><span class="s5">return</span><span class="s1"> {</span><span class="s14">r</span><span class="s1">, </span><span class="s14">c</span><span class="s1">};</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s5">function</span><span class="s1"> </span><span class="s14">same</span><span class="s1">(</span><span class="s14">a</span><span class="s1">,</span><span class="s14">b</span><span class="s1">){ </span><span class="s5">return</span><span class="s1"> </span><span class="s14">a</span><span class="s1">.</span><span class="s14">r</span><span class="s1">===</span><span class="s14">b</span><span class="s1">.</span><span class="s14">r</span><span class="s1"> &amp;&amp; </span><span class="s14">a</span><span class="s1">.</span><span class="s14">c</span><span class="s1">===</span><span class="s14">b</span><span class="s1">.</span><span class="s14">c</span><span class="s1">; }</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s5">function</span><span class="s1"> </span><span class="s14">draw</span><span class="s1">() {</span></p>
<p class="p9"><span class="s4"><span class="Apple-converted-space">      </span></span><span class="s1">// Clear</span></p>
<p class="p11"><span class="s4"><span class="Apple-converted-space">      </span></span><span class="s1">ctx</span><span class="s4">.</span><span class="s1">clearRect</span><span class="s4">(</span><span class="s9">0</span><span class="s4">,</span><span class="s9">0</span><span class="s4">,</span><span class="s1">canvas</span><span class="s4">.</span><span class="s1">width</span><span class="s4">,</span><span class="s1">canvas</span><span class="s4">.</span><span class="s1">height</span><span class="s4">);</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p9"><span class="s4"><span class="Apple-converted-space">      </span></span><span class="s1">// Board background grid (subtle premium vibe)</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">      </span></span><span class="s14">ctx</span><span class="s1">.</span><span class="s14">save</span><span class="s1">();</span></p>
<p class="p11"><span class="s4"><span class="Apple-converted-space">      </span></span><span class="s1">ctx</span><span class="s4">.</span><span class="s1">fillStyle</span><span class="s4"> = </span><span class="s6">'#0b1220'</span><span class="s4">;</span></p>
<p class="p11"><span class="s4"><span class="Apple-converted-space">      </span></span><span class="s1">ctx</span><span class="s4">.</span><span class="s1">fillRect</span><span class="s4">(</span><span class="s1">marginX</span><span class="s4">-</span><span class="s9">2</span><span class="s4">, </span><span class="s1">marginY</span><span class="s4">-</span><span class="s9">2</span><span class="s4">, </span><span class="s12">COLS</span><span class="s4">*</span><span class="s12">CELL</span><span class="s4">+</span><span class="s9">4</span><span class="s4">, </span><span class="s12">ROWS</span><span class="s4">*</span><span class="s12">CELL</span><span class="s4">+</span><span class="s9">4</span><span class="s4">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">      </span></span><span class="s14">ctx</span><span class="s1">.</span><span class="s14">restore</span><span class="s1">();</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p9"><span class="s4"><span class="Apple-converted-space">      </span></span><span class="s1">// Fruit</span></p>
<p class="p11"><span class="s4"><span class="Apple-converted-space">      </span></span><span class="s1">drawCell</span><span class="s4">(</span><span class="s1">food</span><span class="s4">.</span><span class="s1">r</span><span class="s4">, </span><span class="s1">food</span><span class="s4">.</span><span class="s1">c</span><span class="s4">, </span><span class="s6">'#ef4444'</span><span class="s4">);</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p9"><span class="s4"><span class="Apple-converted-space">      </span></span><span class="s1">// Snake</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">      </span></span><span class="s5">for</span><span class="s1"> (</span><span class="s5">let</span><span class="s1"> </span><span class="s14">i</span><span class="s1">=</span><span class="s14">snake</span><span class="s1">.</span><span class="s14">length</span><span class="s1">-</span><span class="s9">1</span><span class="s1">; </span><span class="s14">i</span><span class="s1">&gt;=</span><span class="s9">0</span><span class="s1">; </span><span class="s14">i</span><span class="s1">--) {</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s5">const</span><span class="s1"> </span><span class="s14">seg</span><span class="s1"> = </span><span class="s14">snake</span><span class="s1">[</span><span class="s14">i</span><span class="s1">];</span></p>
<p class="p9"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// head with a highlight, body slightly dimmer</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s14">drawCell</span><span class="s1">(</span><span class="s14">seg</span><span class="s1">.</span><span class="s14">r</span><span class="s1">, </span><span class="s14">seg</span><span class="s1">.</span><span class="s14">c</span><span class="s1">, </span><span class="s14">i</span><span class="s1">===</span><span class="s9">0</span><span class="s1"> ? </span><span class="s6">'#22c55e'</span><span class="s1"> : </span><span class="s6">'#16a34a'</span><span class="s1">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p11"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s5">function</span><span class="s4"> </span><span class="s1">drawCell</span><span class="s4">(</span><span class="s1">r</span><span class="s4">, </span><span class="s1">c</span><span class="s4">, </span><span class="s1">color</span><span class="s4">) {</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">      </span></span><span class="s5">const</span><span class="s1"> </span><span class="s14">x</span><span class="s1"> = </span><span class="s14">marginX</span><span class="s1"> + (</span><span class="s14">c</span><span class="s1">-</span><span class="s9">1</span><span class="s1">) * </span><span class="s12">CELL</span><span class="s1"> + </span><span class="s12">GAP</span><span class="s1">/</span><span class="s9">2</span><span class="s1">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">      </span></span><span class="s5">const</span><span class="s1"> </span><span class="s14">y</span><span class="s1"> = </span><span class="s14">marginY</span><span class="s1"> + (</span><span class="s14">r</span><span class="s1">-</span><span class="s9">1</span><span class="s1">) * </span><span class="s12">CELL</span><span class="s1"> + </span><span class="s12">GAP</span><span class="s1">/</span><span class="s9">2</span><span class="s1">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">      </span></span><span class="s5">const</span><span class="s1"> </span><span class="s14">s</span><span class="s1"> = </span><span class="s12">CELL</span><span class="s1"> - </span><span class="s12">GAP</span><span class="s1">;</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p11"><span class="s4"><span class="Apple-converted-space">      </span></span><span class="s1">ctx</span><span class="s4">.</span><span class="s1">fillStyle</span><span class="s4"> = </span><span class="s1">color</span><span class="s4">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">      </span></span><span class="s14">ctx</span><span class="s1">.</span><span class="s14">fillRect</span><span class="s1">(</span><span class="s14">x</span><span class="s1">, </span><span class="s14">y</span><span class="s1">, </span><span class="s14">s</span><span class="s1">, </span><span class="s14">s</span><span class="s1">);</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p9"><span class="s4"><span class="Apple-converted-space">      </span></span><span class="s1">// glossy outline for premium look</span></p>
<p class="p11"><span class="s4"><span class="Apple-converted-space">      </span></span><span class="s1">ctx</span><span class="s4">.</span><span class="s1">globalAlpha</span><span class="s4"> = </span><span class="s9">0.1</span><span class="s4">;</span></p>
<p class="p11"><span class="s4"><span class="Apple-converted-space">      </span></span><span class="s1">ctx</span><span class="s4">.</span><span class="s1">fillStyle</span><span class="s4"> = </span><span class="s6">'#ffffff'</span><span class="s4">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">      </span></span><span class="s14">ctx</span><span class="s1">.</span><span class="s14">fillRect</span><span class="s1">(</span><span class="s14">x</span><span class="s1">, </span><span class="s14">y</span><span class="s1">, </span><span class="s14">s</span><span class="s1">, </span><span class="s12">Math</span><span class="s1">.</span><span class="s14">max</span><span class="s1">(</span><span class="s9">2</span><span class="s1">, </span><span class="s14">s</span><span class="s1">*</span><span class="s9">0.12</span><span class="s1">));</span></p>
<p class="p11"><span class="s4"><span class="Apple-converted-space">      </span></span><span class="s1">ctx</span><span class="s4">.</span><span class="s1">globalAlpha</span><span class="s4"> = </span><span class="s9">1</span><span class="s4">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p9"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">// --- Game loop ---</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s5">function</span><span class="s1"> </span><span class="s14">step</span><span class="s1">(</span><span class="s14">ts</span><span class="s1">) {</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">      </span></span><span class="s5">if</span><span class="s1"> (!</span><span class="s14">running</span><span class="s1">) </span><span class="s5">return</span><span class="s1">;</span></p>
<p class="p11"><span class="s4"><span class="Apple-converted-space">      </span></span><span class="s5">if</span><span class="s4"> (!</span><span class="s1">lastTick</span><span class="s4">) </span><span class="s1">lastTick</span><span class="s4"> = </span><span class="s1">ts</span><span class="s4">;</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p11"><span class="s4"><span class="Apple-converted-space">      </span></span><span class="s5">const</span><span class="s4"> </span><span class="s1">elapsed</span><span class="s4"> = </span><span class="s1">ts</span><span class="s4"> - </span><span class="s1">lastTick</span><span class="s4">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">      </span></span><span class="s5">if</span><span class="s1"> (</span><span class="s14">elapsed</span><span class="s1"> &gt;= </span><span class="s14">tickMs</span><span class="s1">) {</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s14">lastTick</span><span class="s1"> = </span><span class="s14">ts</span><span class="s1">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s14">tick</span><span class="s1">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p11"><span class="s4"><span class="Apple-converted-space">      </span></span><span class="s1">requestAnimationFrame</span><span class="s4">(</span><span class="s1">step</span><span class="s4">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s5">function</span><span class="s1"> </span><span class="s14">tick</span><span class="s1">() {</span></p>
<p class="p9"><span class="s4"><span class="Apple-converted-space">      </span></span><span class="s1">// Apply pending direction (prevent 180°)</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">      </span></span><span class="s5">if</span><span class="s1"> (</span><span class="s14">pendingDir</span><span class="s1">) {</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s5">const</span><span class="s1"> </span><span class="s14">np</span><span class="s1"> = </span><span class="s14">pendingDir</span><span class="s1">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s5">const</span><span class="s1"> </span><span class="s14">isReverse</span><span class="s1"> = (</span><span class="s14">np</span><span class="s1">.</span><span class="s14">r</span><span class="s1"> === -</span><span class="s14">dir</span><span class="s1">.</span><span class="s14">r</span><span class="s1"> &amp;&amp; </span><span class="s14">np</span><span class="s1">.</span><span class="s14">c</span><span class="s1"> === -</span><span class="s14">dir</span><span class="s1">.</span><span class="s14">c</span><span class="s1">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s5">if</span><span class="s1"> (!</span><span class="s14">isReverse</span><span class="s1">) </span><span class="s14">dir</span><span class="s1"> = </span><span class="s14">np</span><span class="s1">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s14">pendingDir</span><span class="s1"> = </span><span class="s5">null</span><span class="s1">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p9"><span class="s4"><span class="Apple-converted-space">      </span></span><span class="s1">// compute new head</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">      </span></span><span class="s5">const</span><span class="s1"> </span><span class="s14">head</span><span class="s1"> = </span><span class="s14">snake</span><span class="s1">[</span><span class="s9">0</span><span class="s1">];</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">      </span></span><span class="s5">let</span><span class="s1"> </span><span class="s14">nr</span><span class="s1"> = </span><span class="s14">head</span><span class="s1">.</span><span class="s14">r</span><span class="s1"> + </span><span class="s14">dir</span><span class="s1">.</span><span class="s14">r</span><span class="s1">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">      </span></span><span class="s5">let</span><span class="s1"> </span><span class="s14">nc</span><span class="s1"> = </span><span class="s14">head</span><span class="s1">.</span><span class="s14">c</span><span class="s1"> + </span><span class="s14">dir</span><span class="s1">.</span><span class="s14">c</span><span class="s1">;</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p9"><span class="s4"><span class="Apple-converted-space">      </span></span><span class="s1">// walls kill (Nokia 1100)</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">      </span></span><span class="s5">if</span><span class="s1"> (</span><span class="s12">WALLS_KILL</span><span class="s1">) {</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s5">if</span><span class="s1"> (</span><span class="s14">nr</span><span class="s1"> &lt; </span><span class="s9">1</span><span class="s1"> || </span><span class="s14">nr</span><span class="s1"> &gt; </span><span class="s12">ROWS</span><span class="s1"> || </span><span class="s14">nc</span><span class="s1"> &lt; </span><span class="s9">1</span><span class="s1"> || </span><span class="s14">nc</span><span class="s1"> &gt; </span><span class="s12">COLS</span><span class="s1">) {</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">          </span></span><span class="s5">return</span><span class="s4"> </span><span class="s14">gameOver</span><span class="s4">(</span><span class="s1">'</span><span class="s15">💥</span><span class="s1"> Hit the wall'</span><span class="s4">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">      </span>} </span><span class="s5">else</span><span class="s1"> {</span></p>
<p class="p9"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// (not used here) wrap</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s5">if</span><span class="s1"> (</span><span class="s14">nr</span><span class="s1"> &lt; </span><span class="s9">1</span><span class="s1">) </span><span class="s14">nr</span><span class="s1"> = </span><span class="s12">ROWS</span><span class="s1">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s5">if</span><span class="s1"> (</span><span class="s14">nr</span><span class="s1"> &gt; </span><span class="s12">ROWS</span><span class="s1">) </span><span class="s14">nr</span><span class="s1"> = </span><span class="s9">1</span><span class="s1">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s5">if</span><span class="s1"> (</span><span class="s14">nc</span><span class="s1"> &lt; </span><span class="s9">1</span><span class="s1">) </span><span class="s14">nc</span><span class="s1"> = </span><span class="s12">COLS</span><span class="s1">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s5">if</span><span class="s1"> (</span><span class="s14">nc</span><span class="s1"> &gt; </span><span class="s12">COLS</span><span class="s1">) </span><span class="s14">nc</span><span class="s1"> = </span><span class="s9">1</span><span class="s1">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p9"><span class="s4"><span class="Apple-converted-space">      </span></span><span class="s1">// self collision</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">      </span></span><span class="s5">for</span><span class="s1"> (</span><span class="s5">let</span><span class="s1"> </span><span class="s14">i</span><span class="s1">=</span><span class="s9">0</span><span class="s1">;</span><span class="s14">i</span><span class="s1">&lt;</span><span class="s14">snake</span><span class="s1">.</span><span class="s14">length</span><span class="s1">;</span><span class="s14">i</span><span class="s1">++){</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s5">if</span><span class="s1"> (</span><span class="s14">snake</span><span class="s1">[</span><span class="s14">i</span><span class="s1">].</span><span class="s14">r</span><span class="s1"> === </span><span class="s14">nr</span><span class="s1"> &amp;&amp; </span><span class="s14">snake</span><span class="s1">[</span><span class="s14">i</span><span class="s1">].</span><span class="s14">c</span><span class="s1"> === </span><span class="s14">nc</span><span class="s1">) </span><span class="s5">return</span><span class="s1"> </span><span class="s14">gameOver</span><span class="s1">(</span><span class="s6">'</span><span class="s16">💀</span><span class="s6"> Ate yourself'</span><span class="s1">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p9"><span class="s4"><span class="Apple-converted-space">      </span></span><span class="s1">// move</span></p>
<p class="p11"><span class="s4"><span class="Apple-converted-space">      </span></span><span class="s1">snake</span><span class="s4">.</span><span class="s1">unshift</span><span class="s4">({</span><span class="s1">r</span><span class="s4">:</span><span class="s1">nr</span><span class="s4">, </span><span class="s1">c</span><span class="s4">:</span><span class="s1">nc</span><span class="s4">});</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p9"><span class="s4"><span class="Apple-converted-space">      </span></span><span class="s1">// eat / grow</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">      </span></span><span class="s5">if</span><span class="s1"> (</span><span class="s14">same</span><span class="s1">({</span><span class="s14">r</span><span class="s1">:</span><span class="s14">nr</span><span class="s1">,</span><span class="s14">c</span><span class="s1">:</span><span class="s14">nc</span><span class="s1">}, </span><span class="s14">food</span><span class="s1">)) {</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s14">score</span><span class="s1"> += </span><span class="s9">10</span><span class="s1">;</span></p>
<p class="p9"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// level up each FOODS_PER_LEVEL foods</span></p>
<p class="p11"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s5">const</span><span class="s4"> </span><span class="s1">foodsEaten</span><span class="s4"> = </span><span class="s12">Math</span><span class="s4">.</span><span class="s1">floor</span><span class="s4">(</span><span class="s1">score</span><span class="s4">/</span><span class="s9">10</span><span class="s4">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s5">if</span><span class="s1"> (</span><span class="s14">foodsEaten</span><span class="s1"> % </span><span class="s12">FOODS_PER_LEVEL</span><span class="s1"> === </span><span class="s9">0</span><span class="s1">) {</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">          </span></span><span class="s14">level</span><span class="s1">++;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">          </span></span><span class="s14">tickMs</span><span class="s1"> = </span><span class="s12">Math</span><span class="s1">.</span><span class="s14">max</span><span class="s1">(</span><span class="s9">60</span><span class="s1">, </span><span class="s14">tickMs</span><span class="s1"> - </span><span class="s12">SPEED_STEP_MS</span><span class="s1">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">          </span></span><span class="s14">showToast</span><span class="s1">(</span><span class="s6">`Level </span><span class="s1">${</span><span class="s14">level</span><span class="s1">}</span><span class="s6"> ↑`</span><span class="s1">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p11"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">food</span><span class="s4"> = </span><span class="s1">randomEmptyCell</span><span class="s4">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s14">updateHud</span><span class="s1">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">      </span>} </span><span class="s5">else</span><span class="s1"> {</span></p>
<p class="p9"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// normal move (trim tail)</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s14">snake</span><span class="s1">.</span><span class="s14">pop</span><span class="s1">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">      </span></span><span class="s14">draw</span><span class="s1">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p11"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s5">function</span><span class="s4"> </span><span class="s1">gameOver</span><span class="s4">(</span><span class="s1">msg</span><span class="s4">) {</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">      </span></span><span class="s14">running</span><span class="s1"> = </span><span class="s5">false</span><span class="s1">;</span></p>
<p class="p11"><span class="s4"><span class="Apple-converted-space">      </span></span><span class="s1">playPauseBtn</span><span class="s4">.</span><span class="s1">textContent</span><span class="s4"> = </span><span class="s6">'▶ Start'</span><span class="s4">;</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">      </span></span><span class="s14">showToast</span><span class="s4">(</span><span class="s1">`Game Over — </span><span class="s4">${</span><span class="s14">msg</span><span class="s4">}</span><span class="s1"><span class="Apple-converted-space">  </span>·<span class="Apple-converted-space">  </span>Score </span><span class="s4">${</span><span class="s14">score</span><span class="s4">}</span><span class="s1">`</span><span class="s4">);</span></p>
<p class="p11"><span class="s4"><span class="Apple-converted-space">      </span></span><span class="s1">setHighIfBeaten</span><span class="s4">(</span><span class="s1">score</span><span class="s4">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p11"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s5">function</span><span class="s4"> </span><span class="s1">showToast</span><span class="s4">(</span><span class="s1">text</span><span class="s4">) {</span></p>
<p class="p11"><span class="s4"><span class="Apple-converted-space">      </span></span><span class="s1">toastEl</span><span class="s4">.</span><span class="s1">textContent</span><span class="s4"> = </span><span class="s1">text</span><span class="s4">;</span></p>
<p class="p11"><span class="s4"><span class="Apple-converted-space">      </span></span><span class="s1">toastEl</span><span class="s4">.</span><span class="s1">style</span><span class="s4">.</span><span class="s1">opacity</span><span class="s4"> = </span><span class="s6">'0'</span><span class="s4">;</span></p>
<p class="p11"><span class="s4"><span class="Apple-converted-space">      </span></span><span class="s1">toastEl</span><span class="s4">.</span><span class="s1">style</span><span class="s4">.</span><span class="s1">transition</span><span class="s4"> = </span><span class="s6">'none'</span><span class="s4">;</span></p>
<p class="p11"><span class="s4"><span class="Apple-converted-space">      </span></span><span class="s1">requestAnimationFrame</span><span class="s4">(() =&gt; {</span></p>
<p class="p11"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">toastEl</span><span class="s4">.</span><span class="s1">style</span><span class="s4">.</span><span class="s1">transition</span><span class="s4"> = </span><span class="s6">'opacity .25s ease'</span><span class="s4">;</span></p>
<p class="p11"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">toastEl</span><span class="s4">.</span><span class="s1">style</span><span class="s4">.</span><span class="s1">opacity</span><span class="s4"> = </span><span class="s6">'1'</span><span class="s4">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s14">setTimeout</span><span class="s1">(() =&gt; { </span><span class="s14">toastEl</span><span class="s1">.</span><span class="s14">style</span><span class="s1">.</span><span class="s14">opacity</span><span class="s1"> = </span><span class="s6">'0'</span><span class="s1">; }, </span><span class="s9">1400</span><span class="s1">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">      </span>});</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p9"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">// --- Controls ---</span></p>
<p class="p11"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s5">function</span><span class="s4"> </span><span class="s1">setDir</span><span class="s4">(</span><span class="s1">delta</span><span class="s4">) { </span><span class="s1">pendingDir</span><span class="s4"> = </span><span class="s1">delta</span><span class="s4">; }</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p11"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">document</span><span class="s4">.</span><span class="s1">addEventListener</span><span class="s4">(</span><span class="s6">'keydown'</span><span class="s4">, (</span><span class="s1">e</span><span class="s4">) =&gt; {</span></p>
<p class="p11"><span class="s4"><span class="Apple-converted-space">      </span></span><span class="s5">const</span><span class="s4"> </span><span class="s1">k</span><span class="s4"> = </span><span class="s1">e</span><span class="s4">.</span><span class="s1">key</span><span class="s4">.</span><span class="s1">toLowerCase</span><span class="s4">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">      </span></span><span class="s5">if</span><span class="s1"> (</span><span class="s14">k</span><span class="s1"> === </span><span class="s6">' '</span><span class="s1">){ </span><span class="s14">toggleRun</span><span class="s1">(); </span><span class="s14">e</span><span class="s1">.</span><span class="s14">preventDefault</span><span class="s1">(); </span><span class="s5">return</span><span class="s1">; }</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">      </span></span><span class="s5">if</span><span class="s1"> (</span><span class="s14">k</span><span class="s1">===</span><span class="s6">'arrowup'</span><span class="s1">||</span><span class="s14">k</span><span class="s1">===</span><span class="s6">'w'</span><span class="s1">)<span class="Apple-converted-space">  </span></span><span class="s14">setDir</span><span class="s1">({</span><span class="s14">r</span><span class="s1">:-</span><span class="s9">1</span><span class="s1">,</span><span class="s14">c</span><span class="s1">:</span><span class="s9">0</span><span class="s1">});</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">      </span></span><span class="s5">else</span><span class="s1"> </span><span class="s5">if</span><span class="s1"> (</span><span class="s14">k</span><span class="s1">===</span><span class="s6">'arrowdown'</span><span class="s1">||</span><span class="s14">k</span><span class="s1">===</span><span class="s6">'s'</span><span class="s1">) </span><span class="s14">setDir</span><span class="s1">({</span><span class="s14">r</span><span class="s1">:</span><span class="s9">1</span><span class="s1">,</span><span class="s14">c</span><span class="s1">:</span><span class="s9">0</span><span class="s1">});</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">      </span></span><span class="s5">else</span><span class="s1"> </span><span class="s5">if</span><span class="s1"> (</span><span class="s14">k</span><span class="s1">===</span><span class="s6">'arrowleft'</span><span class="s1">||</span><span class="s14">k</span><span class="s1">===</span><span class="s6">'a'</span><span class="s1">) </span><span class="s14">setDir</span><span class="s1">({</span><span class="s14">r</span><span class="s1">:</span><span class="s9">0</span><span class="s1">,</span><span class="s14">c</span><span class="s1">:-</span><span class="s9">1</span><span class="s1">});</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">      </span></span><span class="s5">else</span><span class="s1"> </span><span class="s5">if</span><span class="s1"> (</span><span class="s14">k</span><span class="s1">===</span><span class="s6">'arrowright'</span><span class="s1">||</span><span class="s14">k</span><span class="s1">===</span><span class="s6">'d'</span><span class="s1">) </span><span class="s14">setDir</span><span class="s1">({</span><span class="s14">r</span><span class="s1">:</span><span class="s9">0</span><span class="s1">,</span><span class="s14">c</span><span class="s1">:</span><span class="s9">1</span><span class="s1">});</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span>});</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p11"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">document</span><span class="s4">.</span><span class="s1">getElementById</span><span class="s4">(</span><span class="s6">'up'</span><span class="s4">).</span><span class="s1">onclick</span><span class="s4"> = () =&gt; </span><span class="s1">setDir</span><span class="s4">({</span><span class="s1">r</span><span class="s4">:-</span><span class="s9">1</span><span class="s4">,</span><span class="s1">c</span><span class="s4">:</span><span class="s9">0</span><span class="s4">});</span></p>
<p class="p11"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">document</span><span class="s4">.</span><span class="s1">getElementById</span><span class="s4">(</span><span class="s6">'down'</span><span class="s4">).</span><span class="s1">onclick</span><span class="s4"> = () =&gt; </span><span class="s1">setDir</span><span class="s4">({</span><span class="s1">r</span><span class="s4">:</span><span class="s9">1</span><span class="s4">,</span><span class="s1">c</span><span class="s4">:</span><span class="s9">0</span><span class="s4">});</span></p>
<p class="p11"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">document</span><span class="s4">.</span><span class="s1">getElementById</span><span class="s4">(</span><span class="s6">'left'</span><span class="s4">).</span><span class="s1">onclick</span><span class="s4"> = () =&gt; </span><span class="s1">setDir</span><span class="s4">({</span><span class="s1">r</span><span class="s4">:</span><span class="s9">0</span><span class="s4">,</span><span class="s1">c</span><span class="s4">:-</span><span class="s9">1</span><span class="s4">});</span></p>
<p class="p11"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">document</span><span class="s4">.</span><span class="s1">getElementById</span><span class="s4">(</span><span class="s6">'right'</span><span class="s4">).</span><span class="s1">onclick</span><span class="s4"> = () =&gt; </span><span class="s1">setDir</span><span class="s4">({</span><span class="s1">r</span><span class="s4">:</span><span class="s9">0</span><span class="s4">,</span><span class="s1">c</span><span class="s4">:</span><span class="s9">1</span><span class="s4">});</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p11"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">playPauseBtn</span><span class="s4">.</span><span class="s1">onclick</span><span class="s4"> = () =&gt; </span><span class="s1">toggleRun</span><span class="s4">();</span></p>
<p class="p11"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">restartBtn</span><span class="s4">.</span><span class="s1">onclick</span><span class="s4"> <span class="Apple-converted-space">  </span>= () =&gt; { </span><span class="s1">resetState</span><span class="s4">(); };</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s5">function</span><span class="s1"> </span><span class="s14">toggleRun</span><span class="s1">() {</span></p>
<p class="p11"><span class="s4"><span class="Apple-converted-space">      </span></span><span class="s1">running</span><span class="s4"> = !</span><span class="s1">running</span><span class="s4">;</span></p>
<p class="p11"><span class="s4"><span class="Apple-converted-space">      </span></span><span class="s1">playPauseBtn</span><span class="s4">.</span><span class="s1">textContent</span><span class="s4"> = </span><span class="s1">running</span><span class="s4"> ? </span><span class="s6">'</span><span class="s17">⏸</span><span class="s6"> Pause'</span><span class="s4"> : </span><span class="s6">'▶ Start'</span><span class="s4">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">      </span></span><span class="s5">if</span><span class="s1"> (</span><span class="s14">running</span><span class="s1">) {</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s14">lastTick</span><span class="s1"> = </span><span class="s9">0</span><span class="s1">;</span></p>
<p class="p11"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">requestAnimationFrame</span><span class="s4">(</span><span class="s1">step</span><span class="s4">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p8"><span class="s11"></span><br></p>
<p class="p9"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">// --- Boot ---</span></p>
<p class="p11"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">resetState</span><span class="s4">();</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">  </span></span><span class="s3">&lt;/</span><span class="s1">script</span><span class="s3">&gt;</span></p>
<p class="p2"><span class="s3">&lt;/</span><span class="s1">body</span><span class="s3">&gt;</span></p>
<p class="p2"><span class="s3">&lt;/</span><span class="s1">html</span><span class="s3">&gt;</span></p>
<p class="p8"><span class="s11"></span><br></p>
</body>
</html>
